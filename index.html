<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>大麻布 / Hemp Textiles</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet">
<style>
  :root {
    --ink: #111111;
    --paper: #ffffff;
    --paper-warm: #f4f4f4;
    --accent: #111111;
    --accent-light: #999999;
    --rule: #dddddd;
    --text-body: #333333;
    --text-muted: #888888;
  }
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    background-color: var(--paper);
    color: var(--ink);
    font-family: 'Noto Sans JP', 'DM Sans', sans-serif;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
  }

  /* HEADER */
  header {
    padding: 24px 28px 20px;
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    border-bottom: 1px solid var(--rule);
    background: var(--paper);
    position: sticky;
    top: 0;
    z-index: 10;
  }
  .header-title { display: flex; flex-direction: column; gap: 2px; }
  .header-title-ja { font-size: 11px; letter-spacing: 0.25em; color: var(--text-muted); font-weight: 300; }
  .header-title-main { font-size: 15px; letter-spacing: 0.1em; font-weight: 400; color: var(--accent); }
  .lang-toggle { display: flex; border: 1px solid var(--rule); border-radius: 2px; overflow: hidden; flex-shrink: 0; margin-top: 2px; }
  .lang-btn { padding: 5px 12px; font-size: 11px; letter-spacing: 0.1em; cursor: pointer; background: transparent; border: none; color: var(--text-muted); font-family: 'DM Sans', 'Noto Sans JP', sans-serif; transition: all 0.2s; }
  .lang-btn.active { background: var(--accent); color: var(--paper); }

  /* MAIN */
  main { flex: 1; max-width: 600px; margin: 0 auto; width: 100%; padding: 36px 24px 60px; }
  main.list-view { max-width: 960px; }

  /* Item detail */
  .item-badge { display: inline-flex; align-items: baseline; gap: 6px; margin-bottom: 28px; }
  .item-num-label { font-size: 11px; letter-spacing: 0.2em; color: var(--text-muted); text-transform: uppercase; }
  .item-num { font-size: 11px; letter-spacing: 0.2em; color: var(--accent-light); line-height: 1; }
  .item-title { font-size: 22px; font-weight: 400; letter-spacing: 0.05em; line-height: 1.5; margin-bottom: 8px; color: var(--ink); font-style: normal; }
  .item-title em, .item-title-en em, .list-item-title em { font-style: normal; }
  .item-title-en { font-size: 13px; font-weight: 300; color: var(--text-muted); margin-bottom: 28px; letter-spacing: 0.03em; font-style: normal; }

  .item-image-wrap { width: 100%; aspect-ratio: 4/3; margin-bottom: 28px; overflow: hidden; }
  .item-image-wrap img { width: 100%; height: 100%; object-fit: contain; display: block; }
  .image-placeholder { width: 100%; height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 8px; color: var(--text-muted); }
  .image-placeholder-icon { font-size: 32px; opacity: 0.3; }
  .image-placeholder-text { font-size: 11px; letter-spacing: 0.15em; opacity: 0.5; }

  /* Metadata */
  .meta-section { border-top: 1px solid var(--rule); padding-top: 20px; margin-bottom: 28px; }
  .meta-row { display: flex; gap: 16px; padding: 10px 0; border-bottom: 1px solid var(--paper-warm); }
  .meta-label { font-size: 10px; letter-spacing: 0.2em; color: var(--text-muted); width: 70px; flex-shrink: 0; padding-top: 2px; text-transform: uppercase; }
  .meta-value { font-size: 14px; color: var(--text-body); line-height: 1.6; flex: 1; }

  /* Topics accordion */
  .topics-section { padding-top: 20px; }
  .topics-heading {
    font-size: 10px; letter-spacing: 0.25em; color: var(--text-muted);
    text-transform: uppercase; margin-bottom: 12px;
    display: flex; align-items: center; gap: 12px;
  }
  .topics-heading::after { content: ''; flex: 1; height: 1px; background: var(--rule); }

  .topic-item { border-bottom: 1px solid var(--rule); }
  .topic-trigger {
    width: 100%; display: flex; justify-content: space-between; align-items: center;
    padding: 14px 0; background: none; border: none; cursor: pointer;
    text-align: left; gap: 12px; -webkit-tap-highlight-color: transparent;
  }
  .topic-label { font-size: 13px; font-weight: 400; letter-spacing: 0.03em; color: var(--text-body); line-height: 1.5; flex: 1; }
  .topic-trigger:hover .topic-label { color: var(--ink); }
  .topic-arrow { font-size: 16px; color: var(--accent-light); flex-shrink: 0; transition: transform 0.25s ease; line-height: 1; }
  .topic-item.open .topic-arrow { transform: rotate(45deg); }

  .topic-body { overflow: hidden; max-height: 0; transition: max-height 0.35s ease, opacity 0.25s ease; opacity: 0; }
  .topic-item.open .topic-body { max-height: 1000px; opacity: 1; }
  .topic-text { font-size: 13px; line-height: 2.0; color: var(--text-body); font-weight: 300; padding-bottom: 20px; }

  /* List page */
  .list-header { margin-bottom: 32px; }
  .list-title-ja { font-size: 26px; font-weight: 400; letter-spacing: 0.08em; line-height: 1.4; margin-bottom: 4px; }
  .list-title-en { font-size: 13px; font-weight: 300; color: var(--text-muted); letter-spacing: 0.05em; margin-top: 2px; }
  .list-count { font-size: 11px; letter-spacing: 0.2em; color: var(--text-muted); margin-top: 16px; padding-top: 16px; border-top: 1px solid var(--rule); }
  .list-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 1px; background: var(--rule); border: 1px solid var(--rule); overflow: hidden; }
  .list-item { background: var(--paper); padding: 16px; text-decoration: none; color: inherit; display: flex; gap: 12px; align-items: flex-start; transition: background 0.15s; -webkit-tap-highlight-color: transparent; min-width: 0; }
  .list-item:hover, .list-item:active { background: var(--paper-warm); }
  .list-grid::after { content: ''; display: block; background: var(--paper); }
  .list-item-thumb { width: 52px; height: 52px; background: var(--paper-warm); border: 1px solid var(--rule); flex-shrink: 0; overflow: hidden; display: flex; align-items: center; justify-content: center; }
  .list-item-thumb img { width: 100%; height: 100%; object-fit: cover; }
  .list-item-thumb-placeholder { font-size: 18px; opacity: 0.2; }
  .list-item-body { flex: 1; min-width: 0; }
  .list-item-num { font-size: 10px; color: var(--accent-light); letter-spacing: 0.1em; margin-bottom: 2px; }
  .list-item-title { font-size: 12px; font-weight: 400; font-style: normal; letter-spacing: 0.03em; line-height: 1.5; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
  .list-item-meta { font-size: 10px; color: var(--text-muted); margin-top: 3px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
  .list-item-arrow { font-size: 10px; color: var(--rule); align-self: center; flex-shrink: 0; }

  /* Footer */
  footer { padding: 20px 28px; border-top: 1px solid var(--rule); display: flex; justify-content: center; }
  .footer-text { font-size: 10px; letter-spacing: 0.15em; color: var(--text-muted); }

  /* Lightbox */
  .item-image-wrap { cursor: zoom-in; }
  .lightbox {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.92);
    z-index: 100;
    align-items: center;
    justify-content: center;
    padding: 20px;
  }
  .lightbox.active { display: flex; }
  .lightbox img {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
    display: block;
  }
  .lightbox-close {
    position: fixed;
    top: 16px;
    right: 20px;
    color: white;
    font-size: 28px;
    cursor: pointer;
    background: none;
    border: none;
    line-height: 1;
    opacity: 0.8;
  }
  .lightbox-close:hover { opacity: 1; }

  /* Fixed topics (value=3) */
  .fixed-topics-section { padding-top: 20px; margin-bottom: 0; }
  .fixed-topic { margin-bottom: 28px; }
  .fixed-topic-label { font-size: 10px; letter-spacing: 0.2em; text-transform: uppercase; color: var(--text-muted); margin-bottom: 10px; }
  .fixed-topic-text { font-size: 13px; line-height: 2.0; color: var(--text-body); }
  .ref-image-block { margin-top: 28px; }
  .ref-image-block img { width: 100%; max-width: 480px; display: block; cursor: zoom-in; margin-bottom: 10px; }
  .ref-image-caption { font-size: 12px; color: var(--text-body); margin-bottom: 6px; line-height: 1.7; }
  .ref-image-credit { font-size: 10px; color: var(--text-muted); line-height: 1.6; }

  /* Lightbox */
  .lightbox {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.92);
    z-index: 100;
    cursor: zoom-out;
    align-items: center;
    justify-content: center;
  }
  .lightbox.active {
    display: flex;
  }
  .lightbox img {
    max-width: 92vw;
    max-height: 92vh;
    object-fit: contain;
    display: block;
  }
  .lightbox-close {
    position: absolute;
    top: 20px;
    right: 24px;
    color: rgba(255,255,255,0.7);
    font-size: 28px;
    font-weight: 300;
    cursor: pointer;
    line-height: 1;
    background: none;
    border: none;
    padding: 4px 8px;
  }
  .item-image-wrap { cursor: zoom-in; }

  /* Mobile responsive */
  @media (max-width: 480px) {
    header { padding: 16px 18px 14px; }
    .header-title-main { font-size: 13px; }
    main { padding: 24px 16px 48px; }
    .item-title { font-size: 18px; }
    .list-grid { grid-template-columns: 1fr; }
    .list-item { padding: 14px 12px; }
    .list-item-thumb { width: 48px; height: 48px; }
    .list-title-ja { font-size: 22px; }
    .meta-label { width: 56px; font-size: 9px; }
    .meta-value { font-size: 13px; }
    .topic-label { font-size: 12px; }
    .topic-text { font-size: 12px; line-height: 1.9; }
  }

  /* Animation */
  @keyframes fadeUp { from { opacity: 0; transform: translateY(12px); } to { opacity: 1; transform: translateY(0); } }
  .animate-in { animation: fadeUp 0.5s ease forwards; }
  .animate-in.delay-1 { animation-delay: 0.08s; opacity: 0; }
  .animate-in.delay-2 { animation-delay: 0.16s; opacity: 0; }
  .animate-in.delay-3 { animation-delay: 0.24s; opacity: 0; }
  .animate-in.delay-4 { animation-delay: 0.32s; opacity: 0; }
</style>
</head>
<body>

<header>
  <div class="header-title">
    <span class="header-title-ja">Hemp Archive</span>
    <span class="header-title-main" id="header-subtitle">資料詳細</span>
  </div>
  <div class="lang-toggle">
    <button class="lang-btn active" id="btn-en" onclick="setLang('en')">EN</button>
    <button class="lang-btn" id="btn-ja" onclick="setLang('ja')">JP</button>
  </div>
</header>

<div class="lightbox" id="lightbox" onclick="closeLightbox()">
  <button class="lightbox-close" onclick="closeLightbox()">✕</button>
  <img id="lightbox-img" src="" alt="">
</div>

<main id="content"></main>

<footer>
  <span class="footer-text" id="footer-text">Hemp Archive: 1700–1900</span>
</footer>

<script>
// ─── TOPICS（10トピック）─────────────────────────────────────────────────────
// [大麻布とは, 長い歴史, 信仰, 近江晒（南郡印）, 近江晒（御召曝所印）, 洗い張り, オクソザックリ, 被衣, 打敷裏地, 裂（砧仕上げ）]
const TOPICS = [
  {
    label_ja: "大麻布とは",
    label_en: "About Hemp Cloth",
    desc_ja: "大麻は、桑科に属す一年草本で、日本列島に古くから栽培されてきた草木繊維である。大麻繊維を用いて作られた大麻布は、水に浸し、天日に晒すことを繰り返すことで白く柔らかくなるという特性がある。\n\n江戸時代に木綿が普及する以前は、日本人にとって最も身近な布は麻（大麻や苧麻）であった。庶民から上流階級に至るまで幅広く着用されていた。また衣服だけではなく、繊維が耐水性に優れたことから、縄や網など生活の道具にも広く使用されてきた。\n\nしかし、戦後の昭和23年（1948年）、GHQの指令を受けた日本政府により大麻取締法が制定・施行されると、大麻栽培は免許制度へ移行し、国内の生産量は急速に減少した。また紡績に敵さなかったことにより、日本の中で、大麻布は徐々に姿を消していった。",
    desc_en: "Hemp is an annual herbaceous plant of the mulberry family, cultivated in the Japanese archipelago since ancient times. Hemp cloth made from hemp fiber has the characteristic of becoming white and soft through repeated soaking in water and sun-bleaching.\n\nBefore cotton became widespread from the late sixteenth to early seventeenth centuries, the most familiar cloth for Japanese people was <em>asa</em> (hemp and ramie), worn by everyone from commoners to the upper classes. Beyond clothing, its fiber's excellent water resistance made it widely used for daily tools such as rope and netting.\n\nHowever, when the Cannabis Control Act was enforced in 1948 under GHQ command, hemp cultivation moved to a licensing system and domestic production declined rapidly. As hemp fiber was also unsuited to machine spinning, hemp cloth gradually disappeared from Japan."
  },
  {
    label_ja: "長い歴史",
    label_en: "Long History",
    desc_ja: "日本では、縄文時代早期（約1万年前）の福井県・鳥浜貝塚から、大麻の繊維片や種子が出土しており、極めて早い段階から繊維利用が行われていたことが知られている。また、大麻に加え、刺草（イラクサ）、苧麻（チョマ、日本名：カラムシ）などの草木繊維を総称して「麻」と呼び、さまざまな種類の草木が繊維として利用されてきた。",
    desc_en: "In Japan, hemp fiber fragments and seeds have been excavated from the Torihama Shell Midden in Fukui Prefecture, dating to the early Jōmon period approximately 10,000 years ago—evidence that fiber use began at a remarkably early stage. Hemp together with nettle, ramie (<em>choma</em>, Japanese name: <em>karamushi</em>), and other plant fibers are collectively called <em>asa</em>, and a wide variety of plants have been used as textile fibers throughout history."
  },
  {
    label_ja: "信仰",
    label_en: "Ritual and Faith",
    desc_ja: "大麻繊維は、日本では神聖な植物として、神道の信仰において欠かすことができない草木繊維である。現代でも群馬県岩島地区などで栽培されており、天皇即位の儀式で着用される装束や神宮の祭祀に用いられている。",
    desc_en: "Hemp fiber is still cultivated today in areas such as the Iwashima district of Gunma Prefecture, and is used in the ceremonial robes worn at Imperial accession rites and in Shinto shrine rituals. In Japan, hemp is revered as a sacred plant and remains an indispensable fiber in Shinto religious practice."
  },
  {
    label_ja: "近江晒（南郡印）",
    label_en: "Ōmi-sarashi (Nangun Seal)",
    desc_ja: "近江（滋賀県）の産地を示す「南郡曝平大工曲」の朱印がある大麻布の着物。近江での大麻布の生産は、井伊家によって江戸中期から始まったとみられる。近江晒（しろ高宮）と呼ばれる。武士階級の男性が着用したと考えられる着物と、それを解いた裂地。\n\n特に近江晒は、江戸時代の商品学書『萬金産業袋』（三宅也来著／1732年）に「和らかきをいとはぬ人のお召地には、是に勝るはあらじ」と記され、その特筆すべき柔らかな風合いが紹介されていたほどである。",
    desc_en: "This hemp kimono bears a red ink seal certifying its origin in Ōmi Province (present-day Shiga Prefecture). <em>Ōmi-sarashi</em> production flourished in the mid-Edo period (c. 1680–1750) under the patronage of the Ii clan of the Hikone Domain. The collection includes garments believed to have been worn by samurai-class men.\n\n<em>Ōmi-sarashi</em> was highly praised in the 1732 commercial encyclopedia <em>Mankin Sangyō Bukuro</em>: \"For those who prize softness above all, there is nothing finer.\" This historical acclaim serves as a testament to the textile's remarkably supple texture."
  },
  {
    label_ja: "近江晒（御召曝所印）",
    label_en: "Ōmi-sarashi (Gosho Sarashisho Seal)",
    desc_ja: "近江（滋賀県）の晒し場を示す「御召曝所」の朱印が残る大麻布の着物。近江での大麻布の生産は、井伊家によって江戸中期から始まったとみられる。近江晒（しろ高宮）と呼ばれる。近世麻布研究所の繊維検査の結果、近江晒は、大麻布であることがわかっている。武士階級の男性が着用したと考えられる着物と、それを解いた裂地。\n\n特に近江晒は、江戸時代の商品学書『萬金産業袋』（三宅也来著／1732年）に「和らかきをいとはぬ人のお召地には、是に勝るはあらじ」と記され、その特筆すべき柔らかな風合いが紹介されていたほどである。",
    desc_en: "This kimono is made of hemp cloth bearing a red seal from the bleaching site in Ōmi (present-day Shiga Prefecture). <em>Ōmi-sarashi</em> production flourished in the mid-Edo period (c. 1680–1750) under the patronage of the Ii clan of the Hikone Domain. Fiber analysis conducted by the Kinsei Asafu Research Institute has confirmed that <em>Ōmi-sarashi</em> is hemp cloth. The collection includes garments believed to have been worn by samurai-class men.\n\n<em>Ōmi-sarashi</em> was highly praised in the 1732 commercial encyclopedia <em>Mankin Sangyō Bukuro</em>: \"For those who prize softness above all, there is nothing finer.\" This historical acclaim serves as a testament to the textile's remarkably supple texture."
  },
  {
    label_ja: "洗い張りのために端縫いした反物",
    label_en: "Cloth Hemmed for Laundering",
    desc_ja: "大麻布の着物を、洗い張りのために端縫いし、反物の状態にした布。洗い張りとは、着物を一度解いて反物の状態に戻し、水洗いをしたあとに張り板や伸子針で布を整える作業を行う、伝統的な着物の手入れの技法である。この工程を経ることで、布地の風合いや張りが蘇り、再び真新しい着物のように仕立て直すことができる。",
    desc_en: "This hemp kimono has been unstitched and the fabric pieces sewn edge-to-edge into a long bolt for laundering. This reflects the traditional care technique known as <em>arai-hari</em>: the garment is fully disassembled, washed, and then stretched using boards or <em>shinshi</em> (flexible bamboo needles) to restore its shape. This process rejuvenates the texture and body of the cloth, allowing it to be resewn as if it were a brand-new garment."
  },
  {
    label_ja: "オクソザックリ",
    label_en: "Okuso Zakkuri",
    desc_ja: "オクソザックリは、明治時代まで、福井県、石川県、岐阜県のあたりで作られ、使われてきた仕事着である。大麻の苧の粗皮を削り取った際に繊維質が残ったものを「オクソ（苧屑）」と呼ぶ。本来は捨てるオクソを緯糸として再利用し、布として織り上げたものである。",
    desc_en: "<em>Okuso zakkuri</em> is a type of work clothing made and used until the Meiji period (1868–1912) in Fukui, Ishikawa, and Gifu Prefectures in central Honshu, Japan's main island. <em>Okuso</em> (literally, &#8220;flock of <em>o</em>&#8221;) refers to fiber remnants produced when scraping the coarse outer bark off hemp stems. These flocks, usually discarded, are reused as the weft and woven into a textile."
  },
  {
    label_ja: "被衣（かづき）",
    label_en: "Kazuki (Head Veil)",
    desc_ja: "被衣とは、平安時代以降、公家・武家の女性が外出の際に着物を頭から被り顔や姿を覆い隠した装い。古語で「かづく」（頭から被るの意）に由来するとする説がある。被衣には、絹の絽地に家紋を染めたものが用いられた。江戸時代に入ると、被るために襟肩を通常の着物より20cmほど前に下げるように仕立てられた着物も現れた。\n\n本資料は、その時代に作られたものである。江戸時代には顔を完全に隠すことが刺客などによる悪用を招くとして早くに使用が禁止された。",
    desc_en: "<em>Kazuki</em> refers to the practice, from the Heian period (794–1185) onward, in which noblewomen and samurai women draped a kimono over the head when going out, concealing the face and figure. The word is thought to derive from the classical verb <em>kazuku</em> (to drape over the head). <em>Kazuki</em> garments were made in silk gauze dyed with family crests. In the Edo period (1603–1868), purpose-made garments also appeared, tailored with the collar shoulder seam set approximately 20 cm further forward than a standard kimono to facilitate draping.\n\nThis piece dates from that era. In the Edo period, use of the <em>kazuki</em> was banned early on, as completely concealing the face was seen as an invitation to misuse by assassins and others."
  },
  {
    label_ja: "打敷（うちしき）の裏地",
    label_en: "Lining of an Uchishiki (Buddhist Altar Cloth)",
    desc_ja: "打敷の裏生地に使用された大麻布。打敷とは、寺院・仏壇において仏前の卓に用いた布製の仏具である。死者の供養のために、故人が生前に愛用した着物を解いて打敷の表地に仕立て、裏地には大麻布などをつけた。年号や施主の情報を記し、大麻布が生産された明確な時代がわかる貴重な資料である。",
    desc_en: "This hemp cloth was used as the lining of an <em>uchishiki</em>—a decorative cloth placed on an altar table before the Buddha. A beloved kimono of the deceased was disassembled and refashioned as the outer face of an <em>uchishiki</em>, with hemp cloth attached as the lining. Inscriptions of the year and donor's name make these pieces valuable dated records of hemp cloth production."
  },
  {
    label_ja: "裂（砧仕上げ）",
    label_en: "Kire (Kinuta-Finished)",
    desc_ja: "この大麻布は、砧（キヌタ）で打った光沢がある。砧は、もともと洗濯した布を柔らかくし、皺をのばすための生活の道具。苧麻、大麻、絹などの布に、独特の艶を出すためにも用いられる。現代でも、宮古上布などが砧を打った光沢のある布として知られている。",
    desc_en: "This <em>kire</em> has a distinctive sheen produced by beating with a <em>kinuta</em> (fulling block). The <em>kinuta</em> is a tool originally used to soften laundered cloth and smooth out wrinkles; it was also used to impart a characteristic luster to fabrics such as ramie, hemp, and silk. <em>Miyako-jōfu</em> is among the textiles still celebrated today for the lustrous finish produced by <em>kinuta</em> beating."
  }
];

// ─── 参考画像データ
const REF_IMAGES = {
  "ref01": {
    file: "ref01.jpg",
    credit: "Nishikawa Sukenobu, Picture Book: Mount Asaka (Ehon Asakayama), 1739. The Metropolitan Museum of Art, Rogers Fund, 1918 (JIB35). Public domain.",
    caption_ja: "頭から被衣（かづき）を被る江戸時代の女性",
    caption_en: "An Edo-period woman wearing a <em>kazuki</em> head veil"
  },
  "ref02": {
    file: "ref02.jpg",
    credit: "Suzuki Harunobu, The Cloth-Fulling Jewel River, Settsu Province, ca. 1766–67. Courtesy of The Metropolitan Museum of Art, Open Access (Public Domain).",
    caption_ja: "砧（きぬた）で布を打つ女性たち（摂津国多摩川）",
    caption_en: "Women beating cloth with a <em>kinuta</em> fulling block at the Tama River in Settsu Province"
  }
};

// ─── ITEMS
// topics: 10トピックの表示フラグ
// [大麻布とは, 長い歴史, 信仰, 近江晒（南郡印）, 近江晒（御召曝所印）, 洗い張り, オクソザックリ, 被衣, 打敷裏地, 裂（砧仕上げ）]
// 0=非表示, 1=アコーディオン, 3=固定表示
const ITEMS = {
  "1":  { ja: "打敷の裏地",                    en: "Lining of an <em>uchishiki</em> (Buddhist altar cloth)", fiber_ja: "大麻", fiber_en: "Hemp", period_ja: "享保17年（1732年）",                                  period_en: "1732",           region_ja: "",         region_en: "",                image: "1.jpg",  topics: [1,1,1,0,0,0,0,0,3,0], ref_image: null   },
  "2":  { ja: "打敷の裏地",                    en: "Lining of an <em>uchishiki</em> (Buddhist altar cloth)", fiber_ja: "大麻", fiber_en: "Hemp", period_ja: "天明4年（1784年）",                                   period_en: "1784",           region_ja: "",         region_en: "",                image: "2.jpg",  topics: [1,1,1,0,0,0,0,0,3,0], ref_image: null   },
  "3":  { ja: "反物（未仕立て・南郡印）",      en: "Kimono (white, with Nangun seal)",                       fiber_ja: "大麻", fiber_en: "Hemp", period_ja: "江戸後期（1800年頃）",                               period_en: "c. 1800",        region_ja: "滋賀県",   region_en: "Shiga Prefecture", image: "3.jpg",  topics: [1,1,1,3,0,0,0,0,0,0], ref_image: null   },
  "4":  { ja: "洗い張りの張物（南郡印）",      en: "<em>Araihari</em> (washed and re-stretched textile), with Nangun seal", fiber_ja: "大麻", fiber_en: "Hemp", period_ja: "江戸後期（1800年頃）",              period_en: "c. 1800",        region_ja: "滋賀県",   region_en: "Shiga Prefecture", image: "4.jpg",  topics: [1,1,1,3,0,3,0,0,0,0], ref_image: null   },
  "5":  { ja: "裂（砧による光沢あり）",        en: "<em>Kire</em> (kinuta-finished, with sheen)",            fiber_ja: "大麻", fiber_en: "Hemp", period_ja: "江戸後期（1800年頃）",                               period_en: "c. 1800",        region_ja: "",         region_en: "",                image: "5.jpg",  topics: [1,1,1,0,0,0,0,0,0,3], ref_image: "ref02"},
  "6":  { ja: "オクソザックリ",                en: "<em>Okuso zakkuri</em> (coarse hemp textile)",            fiber_ja: "大麻", fiber_en: "Hemp", period_ja: "明治期（1868–1912年頃）",                            period_en: "c. 1868–1912",   region_ja: "福井県",   region_en: "Fukui Prefecture", image: "6.jpg",  topics: [1,1,1,0,0,0,3,0,0,0], ref_image: null   },
  "7":  { ja: "着物（白・南郡印あり）",        en: "Kimono (white, with Nangun seal)",                       fiber_ja: "大麻", fiber_en: "Hemp", period_ja: "江戸後期（1700年代後半–1800年代頃）",                 period_en: "c. 1750–1800",   region_ja: "滋賀県",   region_en: "Shiga Prefecture", image: "7.jpg",  topics: [1,1,1,3,0,0,0,0,0,0], ref_image: null   },
  "8":  { ja: "着物（白）",                    en: "Kimono (white)",                                         fiber_ja: "大麻", fiber_en: "Hemp", period_ja: "江戸後期–明治初期（1800–1880年代頃）",                period_en: "c. 1800–1880",   region_ja: "",         region_en: "",                image: "8.jpg",  topics: [1,1,1,0,0,0,0,0,0,0], ref_image: null   },
  "9":  { ja: "着物（白）",                    en: "Kimono (white)",                                         fiber_ja: "大麻", fiber_en: "Hemp", period_ja: "江戸後期–明治初期（1800–1880年代頃）",                period_en: "c. 1800–1880",   region_ja: "",         region_en: "",                image: "9.jpg",  topics: [1,1,1,0,0,0,0,0,0,0], ref_image: null   },
  "10": { ja: "着物（白・粗めの糸）",          en: "Kimono (white, coarse yarn)",                            fiber_ja: "大麻", fiber_en: "Hemp", period_ja: "江戸後期–明治初期（1800–1880年代頃）",                period_en: "c. 1800–1880",   region_ja: "",         region_en: "",                image: "10.jpg", topics: [1,1,1,0,0,0,0,0,0,0], ref_image: null   },
  "11": { ja: "着物（白）",                    en: "Kimono (white)",                                         fiber_ja: "大麻", fiber_en: "Hemp", period_ja: "江戸後期–明治初期（1800–1880年代頃）",                period_en: "c. 1800–1880",   region_ja: "",         region_en: "",                image: "11.jpg", topics: [1,1,1,0,0,0,0,0,0,0], ref_image: null   },
  "12": { ja: "着物（白・南郡印）",            en: "Kimono (white, with Nangun seal)",                       fiber_ja: "大麻", fiber_en: "Hemp", period_ja: "江戸後期–明治初期（1800–1880年代頃）",                period_en: "c. 1800–1880",   region_ja: "",         region_en: "",                image: "12.jpg", topics: [1,1,1,0,3,0,0,0,0,0], ref_image: null   },
  "13": { ja: "着物（白・補修跡あり）",        en: "Kimono (white, with repair traces)",                     fiber_ja: "大麻", fiber_en: "Hemp", period_ja: "江戸後期–明治初期（1800–1880年代頃）",                period_en: "c. 1800–1880",   region_ja: "",         region_en: "",                image: "13.jpg", topics: [1,1,1,0,0,0,0,0,0,0], ref_image: null   },
  "14": { ja: "着物（白）",                    en: "Kimono (white)",                                         fiber_ja: "大麻", fiber_en: "Hemp", period_ja: "江戸後期–明治初期（1800–1880年代頃）",                period_en: "c. 1800–1880",   region_ja: "",         region_en: "",                image: "14.jpg", topics: [1,1,1,0,0,0,0,0,0,0], ref_image: null   },
  "15": { ja: "被衣（かづき）",                en: "<em>Kazuki</em> (hooded outer garment)",                 fiber_ja: "大麻", fiber_en: "Hemp", period_ja: "江戸中期（1700年代後半頃）",                          period_en: "c. 1750",        region_ja: "",         region_en: "",                image: "15.jpg", topics: [1,1,1,0,0,0,0,3,0,0], ref_image: "ref01"},
};


// ─── STATE ───────────────────────────────────────────────────────────────────
let currentLang = 'en';

function setLang(lang) {
  currentLang = lang;
  document.getElementById('btn-ja').classList.toggle('active', lang === 'ja');
  document.getElementById('btn-en').classList.toggle('active', lang === 'en');
  renderPage();
}

function openLightbox(src, alt) {
  document.getElementById('lightbox-img').src = src;
  document.getElementById('lightbox-img').alt = alt;
  document.getElementById('lightbox').classList.add('active');
  document.body.style.overflow = 'hidden';
}

function closeLightbox() {
  document.getElementById('lightbox').classList.remove('active');
  document.body.style.overflow = '';
}

document.addEventListener('keydown', e => {
  if (e.key === 'Escape') closeLightbox();
});

function toggleTopic(el) {
  const item = el.closest('.topic-item');
  item.classList.toggle('open');
}

function openLightbox(src, alt) {
  document.getElementById('lightbox-img').src = src;
  document.getElementById('lightbox-img').alt = alt;
  document.getElementById('lightbox').classList.add('active');
  document.body.style.overflow = 'hidden';
}
function closeLightbox() {
  document.getElementById('lightbox').classList.remove('active');
  document.body.style.overflow = '';
}
document.addEventListener('keydown', e => { if (e.key === 'Escape') closeLightbox(); });

function getItemId() {
  return new URLSearchParams(window.location.search).get('id');
}

function renderPage() {
  const id = getItemId();
  const main = document.getElementById('content');
  const headerSub = document.getElementById('header-subtitle');
  const footerText = document.getElementById('footer-text');
  const isJa = currentLang === 'ja';

  // LIST VIEW
  if (!id) {
    main.classList.add('list-view');
    headerSub.textContent = isJa ? '資料一覧' : 'All Items';
    footerText.textContent = isJa ? '大麻布アーカイヴ 1700–1900' : 'Hemp Archive: 1700–1900';
    const count = Object.keys(ITEMS).length;
    let gridHtml = Object.entries(ITEMS).map(([key, item]) => {
      const title = isJa ? item.ja : item.en;
      const period = isJa ? item.period_ja : item.period_en;
      const region = isJa ? item.region_ja : item.region_en;
      const meta = [period, region].filter(Boolean).join('　');
      const displayKey = key === '予2' ? '予' : key;
      const thumbHtml = item.image
        ? `<img src="images/${item.image}" alt="${title}" onerror="this.parentElement.innerHTML='<span class=\\'list-item-thumb-placeholder\\'>▪</span>'">`
        : `<span class="list-item-thumb-placeholder">▪</span>`;
      return `
        <a class="list-item" href="?id=${encodeURIComponent(key)}">
          <div class="list-item-thumb">${thumbHtml}</div>
          <div class="list-item-body">
            <div class="list-item-num">No. ${displayKey}</div>
            <div class="list-item-title">${title}</div>
            <div class="list-item-meta">${meta}</div>
          </div>
          <span class="list-item-arrow">›</span>
        </a>`;
    }).join('');
    main.innerHTML = `
      <div class="list-header animate-in">
        <h1 class="list-title-ja">${isJa ? '大麻布アーカイヴ' : 'Hemp Archive'}</h1>
        <p class="list-title-en">1700–1900</p>
        <p class="list-count">${isJa ? `全 ${count} 点` : `${count} items`}</p>
      </div>
      <div class="list-grid">${gridHtml}</div>`;
    return;
  }

  // NOT FOUND
  if (!ITEMS[id]) {
    main.classList.remove('list-view');
    main.innerHTML = `
      <div class="animate-in" style="text-align:center;padding:80px 24px;">
        <p style="font-size:13px;letter-spacing:0.1em;color:var(--text-muted);">
          ${isJa ? '資料が見つかりません。' : 'Item not found.'}
        </p>
        <a href="?" style="display:inline-block;margin-top:20px;font-size:12px;color:var(--accent);letter-spacing:0.1em;">
          ${isJa ? '← 一覧へ戻る' : '← Back to list'}
        </a>
      </div>`;
    return;
  }

  // ITEM DETAIL
  main.classList.remove('list-view');
  const item = ITEMS[id];
  headerSub.textContent = isJa ? '資料詳細' : 'Item Detail';
  footerText.textContent = isJa ? '大麻布アーカイヴ 1700–1900' : 'Hemp Archive: 1700–1900';

  const title = isJa ? item.ja : item.en;
  const fiber = isJa ? item.fiber_ja : item.fiber_en;
  const period = isJa ? item.period_ja : item.period_en;
  const region = isJa ? item.region_ja : item.region_en;
  const displayId = id === '予2' ? '予' : id;

  const imageHtml = item.image
    ? `<img src="images/${item.image}" alt="${title}" onclick="openLightbox('images/${item.image}', '${title}')" onerror="this.parentElement.innerHTML='<div class=\\'image-placeholder\\'><span class=\\'image-placeholder-icon\\'>⬜</span><span class=\\'image-placeholder-text\\'>${item.image}</span></div>'">`
    : `<div class="image-placeholder"><span class="image-placeholder-icon">⬜</span><span class="image-placeholder-text">${isJa ? '画像準備中' : 'Image coming soon'}</span></div>`;

  const metaRows = [
    { label: isJa ? '繊維' : 'Fiber', value: fiber },
    period ? { label: isJa ? '年代' : 'Period', value: period } : null,
    region ? { label: isJa ? '地域' : 'Region', value: region } : null,
  ].filter(Boolean);
  const metaHtml = metaRows.map(r => `
    <div class="meta-row">
      <span class="meta-label">${r.label}</span>
      <span class="meta-value">${r.value}</span>
    </div>`).join('');

  // 固定解説（3）
  const fixedTopics = TOPICS
    .filter((t, i) => item.topics[i] === 3)
    .map(t => {
      const text = isJa ? t.desc_ja : t.desc_en;
      const paras = text.split('\n\n').map(p => `<p class="fixed-topic-text">${p.replace(/\n/g,'<br>')}</p>`).join('');
      return `
    <div class="fixed-topic">
      <p class="fixed-topic-label">${isJa ? t.label_ja : t.label_en}</p>
      ${paras}
    </div>`;
    }).join('');

  // 参考画像
  let refImageHtml = '';
  if (item.ref_image && REF_IMAGES[item.ref_image]) {
    const ref = REF_IMAGES[item.ref_image];
    refImageHtml = `
    <div class="ref-image-block">
      <img src="images/${ref.file}" alt="${isJa ? ref.caption_ja : ref.caption_en}" onclick="openLightbox('images/${ref.file}', '${isJa ? ref.caption_ja : ref.caption_en}')" onerror="this.style.display='none'">
      <p class="ref-image-caption">${isJa ? ref.caption_ja : ref.caption_en}</p>
      <p class="ref-image-credit">${ref.credit}</p>
    </div>`;
  }

  // アコーディオン（1）
  const topicsHtml = TOPICS
    .filter((t, i) => item.topics[i] === 1)
    .map(t => `
    <div class="topic-item">
      <button class="topic-trigger" onclick="toggleTopic(this)">
        <span class="topic-label">${isJa ? t.label_ja : t.label_en}</span>
        <span class="topic-arrow">＋</span>
      </button>
      <div class="topic-body">
        ${(isJa ? t.desc_ja : t.desc_en).split('\n\n').map(p => `<p class="topic-text">${p.replace(/\n/g,'<br>')}</p>`).join('')}
      </div>
    </div>`).join('');

  const accordionSection = topicsHtml ? `
    <div class="topics-section animate-in delay-4">
      <p class="topics-heading">${isJa ? '関連解説' : 'Related Topics'}</p>
      ${topicsHtml}
    </div>` : '';

  main.innerHTML = `
    <a href="?" style="display:block;font-size:11px;letter-spacing:0.15em;color:var(--text-muted);text-decoration:none;margin-bottom:16px;">
      ← ${isJa ? '一覧へ戻る' : 'Back to list'}
    </a>
    <div class="item-badge animate-in">
      <span class="item-num-label">No.</span>
      <span class="item-num">${displayId}</span>
    </div>
    <h1 class="item-title animate-in delay-1">${title}</h1>
    <p class="item-title-en animate-in delay-1">${isJa ? item.en : item.ja}</p>
    <div class="item-image-wrap animate-in delay-2">${imageHtml}</div>
    <div class="meta-section animate-in delay-3">${metaHtml}</div>
    ${fixedTopics ? `<div class="fixed-topics-section animate-in delay-4">${fixedTopics}${refImageHtml}</div>` : ''}
    ${accordionSection}`;
}

renderPage();
</script>
</body>
</html>
